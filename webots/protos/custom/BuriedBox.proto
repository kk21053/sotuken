#VRML_SIM R2025a utf8
# Box structure to physically constrain a leg by surrounding it from all sides
# More effective than sand for BURIED scenario

PROTO BuriedBox [
  field SFVec3f translation      0 0 -10
  field SFRotation rotation      0 0 1 0
  field SFVec3f boxSize          0.15 0.15 0.08
  field SFColor color            0.6 0.4 0.2
  field SFString contactMaterial "buried_box"
  field SFFloat topGap           0.02
] {
  Group {
    children [
      # Bottom box (floor)
      DEF BOTTOM_BOX Solid {
        translation IS translation
        rotation IS rotation
        children [
          Shape {
            appearance PBRAppearance {
              baseColor IS color
              roughness 0.95
              metalness 0
            }
            geometry Box {
              size IS boxSize
            }
          }
        ]
        name "buried_box_bottom"
        contactMaterial IS contactMaterial
        boundingObject Box {
          size IS boxSize
        }
        locked TRUE
      }
      # Top box (lid) - positioned slightly above to leave a small gap
      DEF TOP_BOX Solid {
        translation 0 0 0.1
        rotation IS rotation
        children [
          Shape {
            appearance PBRAppearance {
              baseColor IS color
              roughness 0.95
              metalness 0
            }
            geometry Box {
              size 0.15 0.15 0.04
            }
          }
        ]
        name "buried_box_top"
        contactMaterial IS contactMaterial
        boundingObject Box {
          size 0.15 0.15 0.04
        }
        locked TRUE
      }
      # Left wall
      DEF LEFT_WALL Solid {
        translation -0.075 0 0.05
        rotation IS rotation
        children [
          Shape {
            appearance PBRAppearance {
              baseColor IS color
              roughness 0.95
              metalness 0
            }
            geometry Box {
              size 0.01 0.15 0.1
            }
          }
        ]
        name "buried_box_left"
        contactMaterial IS contactMaterial
        boundingObject Box {
          size 0.01 0.15 0.1
        }
        locked TRUE
      }
      # Right wall
      DEF RIGHT_WALL Solid {
        translation 0.075 0 0.05
        rotation IS rotation
        children [
          Shape {
            appearance PBRAppearance {
              baseColor IS color
              roughness 0.95
              metalness 0
            }
            geometry Box {
              size 0.01 0.15 0.1
            }
          }
        ]
        name "buried_box_right"
        contactMaterial IS contactMaterial
        boundingObject Box {
          size 0.01 0.15 0.1
        }
        locked TRUE
      }
      # Front wall
      DEF FRONT_WALL Solid {
        translation 0 0.075 0.05
        rotation IS rotation
        children [
          Shape {
            appearance PBRAppearance {
              baseColor IS color
              roughness 0.95
              metalness 0
            }
            geometry Box {
              size 0.15 0.01 0.1
            }
          }
        ]
        name "buried_box_front"
        contactMaterial IS contactMaterial
        boundingObject Box {
          size 0.15 0.01 0.1
        }
        locked TRUE
      }
      # Back wall
      DEF BACK_WALL Solid {
        translation 0 -0.075 0.05
        rotation IS rotation
        children [
          Shape {
            appearance PBRAppearance {
              baseColor IS color
              roughness 0.95
              metalness 0
            }
            geometry Box {
              size 0.15 0.01 0.1
            }
          }
        ]
        name "buried_box_back"
        contactMaterial IS contactMaterial
        boundingObject Box {
          size 0.15 0.01 0.1
        }
        locked TRUE
      }
    ]
  }
}
