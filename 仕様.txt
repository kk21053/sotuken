卒業研究として、4足歩行ロボットの故障原因をドローンとの協調診断を用いて特定する研究をシミュレーションを用いて行う。

実施環境を以下に示す。
・webots（シミュレーター）
・spot（4足歩行ロボット）
・DJI' Mavic 2 PRO（ドローン）

実装するwebots内の環境設定について以下に示す。
spotの各脚(FL、FR、RL、RR)に対して個別の環境を設定できるようにする。
各脚に設置できる環境は、それぞれ「正常、故障、埋まる、挟まる、絡まる」の内どれか一つである。一つの脚が複数の環境を同時に設定することはない。
各脚に設置する環境は、簡易スクリプトを実行することで変更できるようにする。例えば、スクリプトを実行して「NONE BURIED TRAPPED NONE」と入力すると、FL=NONE、FR=BURIED、BL=TRAPPED、BR=NONEが適用される。
ドローンは、spotを最も正確に診断できる位置に常に定住している。そして、主に計算などの処理を行うのはドローンとする。
spotからドローンへ通信により情報を送れるようにする。送る通信内容は次の診断の流れの中で言及する。

実装する診断の流れを以下に示す。
1. spotが各脚に対して4回ずつ内部診断を行い、それぞれ動くか動かないかを判断する。この診断基準は「追従性スコア*0.4 + 速度スコア*0.25 + トルクスコア*0.25 + 安全性スコア*0.1」となる。この時spotは各脚を動かす際に毎回ドローンに「どの脚をどのくらい動かすか」を通知する。
2. ドローンはspotから脚を動かすことを通知されたら、その間ロボットの姿勢を監査し、想定通りの動きをしているか診断する。姿勢の監査にはRoboPoseを用いる。この時、脚が拘束されていた場合はspotの胴体が動いてしまう場合もあるため、それも考慮した上で脚がどのくらい動いたかを診断する。
3. spotは全ての脚の診断が終わると、各脚の診断結果を確率（動かないとき0～動くとき1）に変換し、シグモイド関数により値の差をわかりやすくしたうえで、spot_canという各脚の動作確率を格納する変数にその値を代入する。
4. ドローンは全ての脚の診断が終わると、各脚の診断結果を確率（動かないとき0～動くとき1）に変換し、シグモイド関数により値の差をわかりやすくしたうえで、drone_canという各脚の動作確率を格納する変数にその値を代入する。そして、各脚の拘束状況が「正常、故障、埋まる、挟まる、絡まる」の内どれなのかを確率で推論し、各脚の確率分布として保持する。
5. spotはspot_canをドローンへ送る。
6. ドローンはspotから送られてきたspot_canと自身のdrone_can、各脚の拘束状況の確率分布をルールベースLLMに渡す。
7. ルールベースLLMは、ドローンから渡された内容を比較し、最終的なp_can（各脚の動作確率）と各脚の拘束原因を決定する。ルールは次のようになっている。①その脚のspot_canとdrone_canが共に0.7以上なら動くとする。この時、拘束原因は正常に決定する。②その脚のspot_canとdrone_canが共に0.3以下なら動かないとする。この時、拘束原因は確率分布の中の最も確率の高いものに決定する。③その脚のspot_canとdrone_canの、どちらか一方が0.7以上でもう一方が0.3以下なら動かないとする。この時、拘束原因は故障に決定する。④その脚のspot_canとdrone_canのどちらか一方が0.3より高く0.7より低い中間の値なら一部動くとする。この時、拘束原因は確率分布の中の最も確率の高いものに決定する。
8.最後にドローンはspotの姿勢を確認し、spotが転倒しているかどうかを判定する。その結果を確率（転倒していない0～転倒している1）で格納する。
9. 結果(各脚の動く/動かない/一部動く、各脚の拘束原因、転倒してる/してない)をコンソールに表示し、result.pyのようなスクリプトでも確認できるようにする。